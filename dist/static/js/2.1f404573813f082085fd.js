webpackJsonp([2],{"3iXz":function(e,t){},"5zde":function(e,t,r){r("zQR9"),r("qyJz"),e.exports=r("FeBl").Array.from},Gu7T:function(e,t,r){"use strict";t.__esModule=!0;var a,o=r("c/Tr"),s=(a=o)&&a.__esModule?a:{default:a};t.default=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,s.default)(e)}},blep:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Gu7T"),o=r.n(a),s=r("Xxa5"),l=r.n(s),n=r("exGp"),i=r.n(n),c={data:function(){return{tableData:[],addDialogFormVisible:!1,editDialogFormVisible:!1,rolesDialogFormVisible:!1,formObj:{roleName:"",roleDesc:""},formLabelWidth:"100px",rules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},rightsList:[],props:{label:"authName",children:"children"},defaultChecked:[],rolesId:""}},methods:{getAllRolesData:function(){var e=this;return i()(l.a.mark(function t(){var r,a,o,s;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("roles");case 2:r=t.sent,a=r.data,o=a.data,200===(s=a.meta).status?e.tableData=o:e.$message.error(s.msg);case 5:case"end":return t.stop()}},t,e)}))()},showAddDialog:function(){this.formObj={},this.addDialogFormVisible=!0},postAddRoles:function(){var e=this;return i()(l.a.mark(function t(){var r,a,o;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("roles",{roleName:e.formObj.roleName,roleDesc:e.formObj.roleDesc});case 2:r=t.sent,a=r.data,a.data,201===(o=a.meta).status?(e.$message({type:"success",message:o.msg}),e.addDialogFormVisible=!1,e.getAllRolesData()):e.$message.error(o.msg);case 5:case"end":return t.stop()}},t,e)}))()},showEditDialog:function(e){var t=this;return i()(l.a.mark(function r(){var a,o,s,n;return l.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.editDialogFormVisible=!0,r.next=3,t.$http.get("roles/"+e);case 3:a=r.sent,o=a.data,s=o.data,200===(n=o.meta).status?t.formObj=s:t.$message.error(n.msg);case 6:case"end":return r.stop()}},r,t)}))()},editRoles:function(){var e=this;return i()(l.a.mark(function t(){var r,a,o;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.put("roles/"+e.formObj.roleId,{roleName:e.formObj.roleName,roleDesc:e.formObj.roleDesc});case 2:r=t.sent,a=r.data,a.data,200===(o=a.meta).status?(e.$message({type:"success",message:"修改成功"}),e.getAllRolesData()):e.$message.error(o.msg),e.editDialogFormVisible=!1;case 6:case"end":return t.stop()}},t,e)}))()},delRoles:function(e){var t=this;this.$confirm("您确定要删除此角色吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(i()(l.a.mark(function r(){var a,o,s;return l.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$http.delete("roles/"+e);case 2:a=r.sent,o=a.data,o.data,200===(s=o.meta).status?(t.$message({type:"success",message:s.msg}),t.getAllRolesData()):t.$message.error(s.msg);case 5:case"end":return r.stop()}},r,t)}))).catch(function(){t.$message({type:"info",message:"已取消删除"})})},myClose:function(e,t,r){var a=this;return i()(l.a.mark(function o(){var s,n,i,c;return l.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,a.$http.delete("roles/"+e+"/rights/"+t);case 2:s=o.sent,n=s.data,i=n.data,200===(c=n.meta).status?(r.row.children=i,a.$message({type:"success",message:c.msg})):a.$message.error(c.msg);case 5:case"end":return o.stop()}},o,a)}))()},showTree:function(e){var t=this;return i()(l.a.mark(function r(){var a,o,s,n;return l.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.defaultChecked=[],t.rolesId=e.row.id,t.rolesDialogFormVisible=!0,r.next=5,t.$http.get("rights/tree");case 5:a=r.sent,o=a.data,s=o.meta,n=o.data,200===s.status?(t.rightsList=n,e.row.children.forEach(function(e){e.children.forEach(function(e){e.children.forEach(function(e){t.defaultChecked.push(e.id)})})})):t.$message.error(s.msg);case 8:case"end":return r.stop()}},r,t)}))()},setRights:function(){var e=this;return i()(l.a.mark(function t(){var r,a,s,n,i;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=[].concat(o()(e.$refs.tree.getHalfCheckedKeys()),o()(e.$refs.tree.getCheckedKeys())),a=r.join(","),t.next=4,e.$http.post("roles/"+e.rolesId+"/rights",{rids:a});case 4:s=t.sent,n=s.data,n.data,200===(i=n.meta).status?(e.$message({type:"success",message:i.msg}),e.getAllRolesData()):e.$message.error(i.msg),e.rolesDialogFormVisible=!1;case 8:case"end":return t.stop()}},t,e)}))()}},created:function(){this.getAllRolesData()},components:{breadNav:r("Gr30").a}},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-card",[r("breadNav",{attrs:{nav1:"权限管理",nav2:"角色列表"}}),e._v(" "),r("el-row",{staticClass:"addBtnRow"},[r("el-col",[r("el-button",{attrs:{plain:""},on:{click:e.showAddDialog}},[e._v("添加角色")])],1)],1),e._v(" "),r("el-table",{staticStyle:{width:"100%"},attrs:{border:!0,data:e.tableData}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.children,function(a){return r("el-row",[r("el-col",{attrs:{span:4}},[r("el-tag",{attrs:{closable:""},on:{close:function(r){return e.myClose(t.row.id,a.id,t)}}},[e._v(e._s(a.authName))]),e._v(" "),r("i",{staticClass:"el-icon-arrow-right"})],1),e._v(" "),r("el-col",{attrs:{span:20}},e._l(a.children,function(a){return r("el-row",[r("el-col",{attrs:{span:6}},[r("el-tag",{attrs:{type:"success",closable:""},on:{close:function(r){return e.myClose(t.row.id,a.id,t)}}},[e._v(e._s(a.authName)+"\n                ")]),e._v(" "),r("i",{staticClass:"el-icon-arrow-right"})],1),e._v(" "),r("el-col",{attrs:{span:18}},e._l(a.children,function(a){return r("el-tag",{staticClass:"thirdLevel",attrs:{type:"warning",closable:""},on:{close:function(r){return e.myClose(t.row.id,a.id,t)}}},[e._v("\n                  "+e._s(a.authName)+"\n                ")])}),1)],1)}),1)],1)})}}])}),e._v(" "),r("el-table-column",{attrs:{type:"index"}}),e._v(" "),r("el-table-column",{attrs:{prop:"roleName",label:"角色名称"}}),e._v(" "),r("el-table-column",{attrs:{prop:"roleDesc",label:"角色描述"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",plain:"",size:"mini"},on:{click:function(r){return e.showEditDialog(t.row.id)}}}),e._v(" "),r("el-button",{attrs:{type:"success",icon:"el-icon-check",plain:"",size:"mini"},on:{click:function(r){return e.showTree(t)}}}),e._v(" "),r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",plain:"",size:"mini"},on:{click:function(r){return e.delRoles(t.row.id)}}})]}}])})],1),e._v(" "),r("el-dialog",{attrs:{title:"添加角色",visible:e.addDialogFormVisible},on:{"update:visible":function(t){e.addDialogFormVisible=t}}},[r("el-form",{attrs:{rules:e.rules,model:e.formObj}},[r("el-form-item",{attrs:{prop:"roleName",label:"角色名称","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.formObj.roleName,callback:function(t){e.$set(e.formObj,"roleName",t)},expression:"formObj.roleName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"角色描述","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.formObj.roleDesc,callback:function(t){e.$set(e.formObj,"roleDesc",t)},expression:"formObj.roleDesc"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addDialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.postAddRoles}},[e._v("添 加")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"编辑角色",visible:e.editDialogFormVisible},on:{"update:visible":function(t){e.editDialogFormVisible=t}}},[r("el-form",{attrs:{rules:e.rules,model:e.formObj}},[r("el-form-item",{attrs:{prop:"roleName",label:"角色名称","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.formObj.roleName,callback:function(t){e.$set(e.formObj,"roleName",t)},expression:"formObj.roleName"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"roleDesc",label:"角色描述","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.formObj.roleDesc,callback:function(t){e.$set(e.formObj,"roleDesc",t)},expression:"formObj.roleDesc"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editDialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return t.preventDefault(),e.editRoles(t)}}},[e._v("修 改")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"权限分配",visible:e.rolesDialogFormVisible},on:{"update:visible":function(t){e.rolesDialogFormVisible=t}}},[r("el-tree",{ref:"tree",attrs:{data:e.rightsList,"show-checkbox":"",props:e.props,"default-expand-all":!0,"default-checked-keys":e.defaultChecked,"node-key":"id"}}),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.rolesDialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return t.preventDefault(),e.setRights(t)}}},[e._v("提交 权限")])],1)],1)],1)},staticRenderFns:[]};var d=r("VU/8")(c,u,!1,function(e){r("3iXz")},"data-v-70f98ecd",null);t.default=d.exports},"c/Tr":function(e,t,r){e.exports={default:r("5zde"),__esModule:!0}},fBQ2:function(e,t,r){"use strict";var a=r("evD5"),o=r("X8DO");e.exports=function(e,t,r){t in e?a.f(e,t,o(0,r)):e[t]=r}},qyJz:function(e,t,r){"use strict";var a=r("+ZMJ"),o=r("kM2E"),s=r("sB3e"),l=r("msXi"),n=r("Mhyx"),i=r("QRG4"),c=r("fBQ2"),u=r("3fs2");o(o.S+o.F*!r("dY0y")(function(e){Array.from(e)}),"Array",{from:function(e){var t,r,o,d,f=s(e),m="function"==typeof this?this:Array,p=arguments.length,b=p>1?arguments[1]:void 0,g=void 0!==b,h=0,v=u(f);if(g&&(b=a(b,p>2?arguments[2]:void 0,2)),void 0==v||m==Array&&n(v))for(r=new m(t=i(f.length));t>h;h++)c(r,h,g?b(f[h],h):f[h]);else for(d=v.call(f),r=new m;!(o=d.next()).done;h++)c(r,h,g?l(d,b,[o.value,h],!0):o.value);return r.length=h,r}})}});
//# sourceMappingURL=2.1f404573813f082085fd.js.map